#
# WARNING: THIS CONFIGURATION WAS GENERATED BY KATELLO-CONFIGURE TOOL,
# CHANGES WILL LIKELY BE OVERWRITTEN. IF YOU WISH TO PRESERVE ANY CHANGES
# TO THIS FILE PLEASE EDIT /usr/share/katello/install/default-answer-file
# FOR THE CORRESPONDING OPTION AND RERUN katello-configure.
#

# Katello configuration
#
# :vim:sw=2:ts=2:et:

# see /usr/share/katello/config.katello_defaults.yml for available options

common:
  app_mode: <%= scope.lookupvar("katello::params::deployment") %>

  warden:  <%= scope.lookupvar("katello::params::auth_method") %>
  ldap_roles: <%= scope.lookupvar("katello::params::ldap_roles") %>
  validate_ldap: <%= scope.lookupvar("katello::params::validate_ldap") %>
  rest_client_timeout: 120

  url_prefix: <%= scope.lookupvar("katello::params::deployment_url") %>
  host: <%= has_variable?("fqdn") ? @fqdn : hostname %>
  port:
  use_ssl: true
  use_foreman: <%= scope.lookupvar("katello::params::use_foreman") %>

  post_sync_url: http://localhost:5000/<%= scope.lookupvar("katello::params::deployment_url") %>/api/repositories/sync_complete

  candlepin:
    url: <%= scope.lookupvar("katello::params::candlepin_url") %>
    oauth_key: <%= scope.lookupvar("katello::params::oauth_key") %>
    oauth_secret: <%= scope.lookupvar("katello::params::oauth_secret") %>

  pulp:
    url: <%= scope.lookupvar("katello::params::pulp_url") %>
    oauth_key: <%= scope.lookupvar("katello::params::oauth_key") %>
    oauth_secret: <%= scope.lookupvar("katello::params::oauth_secret") %>

  foreman:
    url: <%= scope.lookupvar("katello::params::foreman_url") %>
    oauth_key: <%= scope.lookupvar("katello::params::foreman_oauth_key") %>
    oauth_secret: <%= scope.lookupvar("katello::params::oauth_secret") %>

  cloud_forms:
    oauth_key: <%= scope.lookupvar("katello::params::oauth_key") %>
    oauth_secret: <%= scope.lookupvar("katello::params::oauth_secret") %>

<%- unless scope.lookupvar("katello::params::proxy_url") == "NONE" -%>
  cdn_proxy:
    host: <%= scope.lookupvar("katello::params::proxy_url") %>
    port: <%= scope.lookupvar("katello::params::proxy_port") unless scope.lookupvar("katello::params::proxy_port") == "NONE" %>
    user: <%= scope.lookupvar("katello::params::proxy_user") unless scope.lookupvar("katello::params::proxy_user") == "NONE" %>
    password: <%= scope.lookupvar("katello::params::proxy_pass") unless scope.lookupvar("katello::params::proxy_pass") == "NONE" %>
<%- end -%>

  ldap_fluff_config:
    host: <%= scope.lookupvar("katello::params::ldap_server") %>
    port: <%= scope.lookupvar("katello::params::ldap_port") %>
    encryption: <%= scope.lookupvar("katello::params::ldap_encryption") %>
    base_dn: <%= scope.lookupvar("katello::params::ldap_users_basedn") %>
    group_base: <%= scope.lookupvar("katello::params::ldap_groups_basedn") %>
    server_type: <%= scope.lookupvar("katello::params::ldap_server_type") %>
    service_user: <%= scope.lookupvar("katello::params::ldap_service_user") %>
    service_pass: <%= scope.lookupvar("katello::params::ldap_service_pass") %>
    anon_queries: <%= scope.lookupvar("katello::params::ldap_anon_queries") %>
    ad_domain: <%= scope.lookupvar("katello::params::ldap_ad_domain") %>

  # authentication
  sso:
    <%- if scope.lookupvar("katello::params::deployment") == 'katello' -%>
    enable: true
    <%- end -%>
    <%- if scope.lookupvar("katello::params::deployment") == 'headpin' -%>
    enable: false
    <%- end -%>
    provider_url: https://<%= scope.lookupvar('fqdn') -%>/signo
    logout_path: /logout

  database:
    username:
    password:

<%# bug #7991 in puppet 2.6 - need to explicitly load custom functions %>
<% Puppet::Parser::Functions::function('katello_passencrypt') %>

production:
  database:
    username: <%= scope.lookupvar("katello::params::db_user") %>
    password: <%= scope.function_katello_passencrypt([scope.lookupvar("katello::params::db_pass")]) %>
    database: <%= scope.lookupvar("katello::params::db_name") %>
